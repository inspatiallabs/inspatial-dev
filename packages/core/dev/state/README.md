<!-->This will never change <-->
<div align="center">
    <a href="https://inspatiallabs.com" target="_blank">
    <picture>
        <source media="(prefers-color-scheme: light)" srcset="https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/icon-brutal-light.svg">
        <source media="(prefers-color-scheme: dark)" srcset="https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/icon-brutal-dark.svg">
        <img src="https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/icon-brutal-dark.svg" alt="InSpatial" width="300"/>
    </picture>
    </a>

<br>
   <br>

<a href="https://inspatiallabs.com" target="_blank">
<p align="center">
    <picture>
        <source media="(prefers-color-scheme: light)" srcset="https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/logo-light.svg">
        <source media="(prefers-color-scheme: dark)" srcset="https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/logo-dark.svg">
        <img src="https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/logo-dark.svg" height="75" alt="InSpatial">
    </picture>
</p>
</a>

_Reality is your canvas_

<!-->This will never change <-->
<h3 align="center">
    InSpatial is a universal development environment (UDE) <br> for building cross-platform and spatial (AR/MR/VR) applications
  </h3>

[![InSpatial Dev](https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/dev-badge.svg)](https://www.inspatial.dev)
[![InSpatial Cloud](https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/cloud-badge.svg)](https://www.inspatial.cloud)
[![InSpatial App](https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/app-badge.svg)](https://www.inspatial.app)
[![InSpatial Store](https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/store-badge.svg)](https://www.inspatial.store)

[![License](https://img.shields.io/badge/license-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![Discord](https://img.shields.io/badge/discord-join_us-5a66f6.svg?style=flat-square)](https://discord.gg/inspatiallabs)
[![Twitter](https://img.shields.io/badge/twitter-follow_us-1d9bf0.svg?style=flat-square)](https://twitter.com/inspatiallabs)
[![LinkedIn](https://img.shields.io/badge/linkedin-connect_with_us-0a66c2.svg?style=flat-square)](https://www.linkedin.com/company/inspatiallabs)

</div>

<!-->This will never change <-->
##

<div align="center">

| InSpatial                                        | Description                          | Link             |
| --- | --- | ---- |
| [![InSpatial Dev](https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/dev-badge.svg)](https://www.inspatial.dev)     | Universal Libraries & Frameworks     | [inspatial.dev](https://www.inspatial.dev)   |
| [![InSpatial Cloud](https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/cloud-badge.svg)](https://www.inspatial.cloud) | Backend APIs and SDKs                | [inspatial.cloud](https://www.inspatial.cloud) |
| [![InSpatial App](https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/app-badge.svg)](https://www.inspatial.app)     | Build and manage your InSpatial apps | [inspatial.app](https://www.inspatial.app)   |
| [![InSpatial Store](https://inspatial-storage.s3.eu-west-2.amazonaws.com/media/store-badge.svg)](https://www.inspatial.store) | Deploy and discover InSpatial apps   | [inspatial.store](https://www.inspatial.store) |

</div>

---

## 🔍 InSpatial State (🟡 Preview)

Universal state management with powerful type validation for all InSpatial applications.

### 👨‍💻 What Can I Do With InSpatial State?

- **Unified State Management**: Create, update, and sync state across your entire application with a clean API
- **Runtime Type Validation**: Ensure your state always matches its expected shape with the InSpatial Type system
- **Trigger Integration**: Connect state to triggers for reactive programming patterns
- **Expressive Updates**: Use either standard object updates or StateQL template literals for natural syntax
- **Schema Generation**: Generate JSON Schema documentation from your state types

## 🌟 Features

- 🌍 **Universal Compatibility**: Works on all platforms - web, mobile, XR and more
- 🔍 **Single Source of Truth**: Maintain consistent state across your application
- 🎮 **Integrated State Triggers**: Connect actions directly to state updates
- 📝 **Type-Safe State**: Runtime validation using InSpatial Type system
- 🎯 **Intuitive API**: Simple get/update methods with minimal boilerplate
- ⚡ **Optimized Performance**: Fine-tuned for minimal re-renders and updates
- 🔄 **Computed Values**: Create derived values that update automatically
- 🔍 **Persistence Layer**: Optional storage of state in various backends
- 🎨 **Expressive Updates**: Template literals for more intuitive state changes
- 🛡️ **Schema Validation**: Runtime checking of state against schemas
- 🔄 **Batched Updates**: Performance optimization for multiple updates
- 🧪 **Time-Travel Debugging**: Dev tools for tracking state changes
- 📝 **Documentation Generation**: Auto-generate API docs from state schema
- 🧩 **Composable Design**: Build complex state from simpler pieces
- 📸 **State Snapshots**: Create and restore snapshots for testing

## ✨ Advanced Features ✨

<div class="features-grid">
  <div class="feature-tile" onclick="showFeatureDetails('feature-system-1')">
    <span class="feature-icon">🔄</span>
    <h4>Type-Safe State</h4>
    <p class="feature-brief">Runtime validation with InSpatial Type system</p>
  </div>
  
  <div class="feature-tile" onclick="showFeatureDetails('feature-system-2')">
    <span class="feature-icon">🧩</span>
    <h4>Trigger Integration</h4>
    <p class="feature-brief">Connect triggers to state updates</p>
  </div>
  
  <div class="feature-tile" onclick="showFeatureDetails('feature-system-3')">
    <span class="feature-icon">⚡</span>
    <h4>StateQL</h4>
    <p class="feature-brief">Template literals for expressive updates</p>
  </div>
  
  <div class="feature-tile" onclick="showFeatureDetails('feature-system-4')">
    <span class="feature-icon">📋</span>
    <h4>Computed State</h4>
    <p class="feature-brief">Derived values that update automatically</p>
  </div>
  
  <div class="feature-tile" onclick="showFeatureDetails('feature-system-5')">
    <span class="feature-icon">🔒</span>
    <h4>Persistence</h4>
    <p class="feature-brief">Store state with flexible backends</p>
  </div>
</div>

<div id="feature-details-container">
  <div class="feature-detail" id="feature-system-1">
    <h4>🔄 Type-Safe State</h4>
    <p>InSpatial State integrates deeply with the InSpatial Type system to provide runtime validation of your state. This ensures your application state always matches its expected shape, catching errors before they cause problems.</p>
    <pre><code>// Define a state with type validation
const userState = createState({
  id: "user",
  initialState: { name: "John", age: 30 },
  type: type({
    name: "string",
    age: "number|>0|<120"
  })
});

// Valid update - passes validation
userState.update({ age: 31 });

// Invalid update - type error caught at runtime
userState.update({ age: "not a number" });

// Disable validation if needed
const debugState = createState({
  id: "debug",
  initialState: { level: "info" },
  type: LogLevelType
}, {
  validateType: false
});
</code></pre>
    <ul class="feature-benefits">
      <li>Benefit 1: Catch type errors early at runtime</li>
      <li>Benefit 2: Self-documenting state with schema definitions</li>
      <li>Benefit 3: JSON Schema generation for documentation</li>
      <li>Benefit 4: Disable validation in specific cases when needed</li>
    </ul>
  </div>
  
  <div class="feature-detail" id="feature-system-2">
    <h4>🧩 Trigger Integration</h4>
    <p>Connect state to triggers for a clean, reactive programming model. Triggers are automatically bound to state updating functions, creating a declarative way to respond to events.</p>
    <pre><code>// Define a trigger
const incrementTrigger = registerTrigger("counter:increment", 
  (state, amount = 1) => ({
    count: state.count + amount
  })
);

// Create state with the trigger
const counterState = createState({
  initialState: { count: 0 },
  triggers: ["counter:increment"]
});

// Use the generated action
counterState.action.increment(5); // Adds 5 to count
</code></pre>
    <ul class="feature-benefits">
      <li>Benefit 1: Clean separation of events and state logic</li>
      <li>Benefit 2: Automatic action generation</li>
      <li>Benefit 3: Consistent state update patterns</li>
    </ul>
  </div>
  
  <div class="feature-detail" id="feature-system-3">
    <h4>⚡ StateQL</h4>
    <p>StateQL provides a more expressive way to update state using JavaScript template literals. This creates a natural, code-like syntax for state updates that's both readable and powerful.</p>
    <pre><code>// Create state with StateQL support
const playerState = stateQL(createState({
  initialState: {
    health: 100,
    position: { x: 0, y: 0 },
    inventory: []
  }
}));

// Use template literals for natural updates
playerState.update`
  health -= 10,
  position.x += 5,
  position.y += 3,
  inventory.push(${newItem})
`;

// Conditional updates
playerState.update`
  if (health < 20) {
    status = "critical",
    effects.push("wounded")
  } else {
    status = "normal"
  }
`;
</code></pre>
    <ul class="feature-benefits">
      <li>Benefit 1: More natural expression of state changes</li>
      <li>Benefit 2: Support for arithmetic operations</li>
      <li>Benefit 3: Conditional logic inside state updates</li>
    </ul>
  </div>
  
  <div class="feature-detail" id="feature-system-4">
    <h4>📋 Computed State</h4>
    <p>Create derived values that update automatically when their dependencies change. This provides a clean way to transform and compute values from your state without manual tracking.</p>
    <pre><code>// Base state
const cartState = createState({
  initialState: {
    items: [
      { name: "Product 1", price: 10, quantity: 2 },
      { name: "Product 2", price: 15, quantity: 1 }
    ]
  }
});

// Create computed values
const totalItems = createComputed(() => {
  return cartState.get().items.reduce((sum, item) => 
    sum + item.quantity, 0);
});

const totalPrice = createComputed(() => {
  return cartState.get().items.reduce((sum, item) => 
    sum + (item.price * item.quantity), 0);
});

// Computed values update automatically when state changes
cartState.update({ 
  items: [...cartState.get().items, 
    { name: "Product 3", price: 20, quantity: 1 }]
});

console.log(totalItems()); // 4
console.log(totalPrice()); // 55
</code></pre>
    <ul class="feature-benefits">
      <li>Benefit 1: Automatic updates when dependencies change</li>
      <li>Benefit 2: Eliminates manual tracking of dependencies</li>
      <li>Benefit 3: Optimized with memoization for performance</li>
    </ul>
  </div>
  
  <div class="feature-detail" id="feature-system-5">
    <h4>🔒 Persistence</h4>
    <p>Store your application state with flexible persistence options, from browser localStorage to remote databases. Easy configuration with automatic synchronization.</p>
    <pre><code>// Create state with persistence
const userPrefsState = createState({
  id: "userPrefs",
  initialState: {
    theme: "light",
    fontSize: "medium",
    notifications: true
  },
  persist: {
    storage: "localStorage",
    key: "user-preferences",
    autoSave: true
  }
});

// State will automatically be saved to localStorage
userPrefsState.update({ theme: "dark" });

// Later or on page reload, state will be restored
// from localStorage automatically
</code></pre>
    <ul class="feature-benefits">
      <li>Benefit 1: Multiple storage backends (localStorage, sessionStorage, remote)</li>
      <li>Benefit 2: Automatic save and restore</li>
      <li>Benefit 3: Selective persistence with include/exclude fields</li>
    </ul>
  </div>
</div>

<div align="center">
  <h4>🚀 Keep reading to learn how to use all these amazing features! 🚀</h4>
</div>

## 📦 Install InSpatial State:

Choose your preferred package manager:

```bash
deno install jsr:@inspatial/state
```

##

```bash
npx jsr add @inspatial/state
```

##

```bash
yarn dlx jsr add @inspatial/state
```

##

```bash
pnpm dlx jsr add @inspatial/state
```

##

```bash
bunx jsr add @inspatial/state
```

## 🛠️ Step-by-Step Usage Guide

Here are the essential usage patterns for working with InSpatial State:

### 1. **Basic State Creation**

```typescript
import { createState } from "@inspatial/state"

// Create a simple counter state
const counterState = createState({
  id: "counter", // Optional ID for global reference
  initialState: { count: 0 }
});

// Read the state
console.log(counterState.get().count); // 0

// Update the state
counterState.update({ count: 1 });
// or
counterState.update(state => ({ count: state.count + 1 }));

// Subscribe to changes
const unsubscribe = counterState.subscribe(state => {
  console.log("Counter changed:", state.count);
});

// Clean up when done
unsubscribe();
// or
counterState.destroy();
```

### 2. **Type-Safe State with Validation**

```typescript
import { createState } from "@inspatial/state"
import { type } from "@inspatial/type"

// Define a user profile type
const UserProfileType = type({
  username: "string|minLength(3)|maxLength(20)",
  email: "string|regex(/@.+\\..+$/)",
  age: "number|>=18|<=120"
});

// Create a state with type validation (enabled by default)
const userState = createState({
  id: "user",
  initialState: {
    username: "johndoe",
    email: "john@example.com",
    age: 30
  },
  type: UserProfileType
});

// Valid update - passes validation
userState.update({ age: 31 });

// Invalid update - triggers validation error
try {
  userState.update({ age: 15 }); // Age below minimum
} catch (error) {
  console.error("Validation failed:", error);
}

// You can also disable validation if needed
const nonValidatedState = createState({
  id: "settings",
  initialState: { theme: "light" },
  type: ThemeType
}, {
  validateType: false // Disable validation
});
```

### 3. **Connecting Triggers to State**

```typescript
import { createState } from "@inspatial/state"
import { registerTrigger } from "@inspatial/trigger"

// Define triggers
const incrementTrigger = registerTrigger("counter:increment", 
  (state, amount = 1) => ({
    count: state.count + amount
  })
);

const resetTrigger = registerTrigger("counter:reset", 
  state => ({ count: 0 })
);

// Create state with triggers
const counterState = createState({
  initialState: { count: 0 },
  triggers: ["counter:increment", "counter:reset"]
});

// Use the auto-generated actions
counterState.action.increment(5); // count = 5
counterState.action.reset();      // count = 0

// Add a trigger dynamically
const multiplyTrigger = registerTrigger("counter:multiply", 
  (state, factor = 2) => ({
    count: state.count * factor
  })
);

counterState.connectTrigger(multiplyTrigger);
counterState.action.multiply(10); // count = 0 * 10 = 0
```

### 4. **Using StateQL for Expressive Updates**

```typescript
import { createState, stateQL } from "@inspatial/state"

// Create a state with StateQL
const gameState = stateQL(createState({
  initialState: {
    player: {
      health: 100,
      mana: 50,
      position: { x: 0, y: 0, z: 0 },
      inventory: []
    },
    enemies: [],
    gameTime: 0
  }
}));

// Use template literals for updates
gameState.update`
  player.health -= 10,
  player.mana -= 5,
  player.position.x += 5,
  player.position.y += 2
`;

// Interpolate dynamic values
const newItem = { id: "potion", name: "Health Potion", quantity: 1 };
gameState.update`player.inventory.push(${newItem})`;

// Conditional updates
gameState.update`
  if (player.health < 30) {
    player.status = "critical",
    player.effects.push("injured")
  } else if (player.health < 70) {
    player.status = "wounded" 
  } else {
    player.status = "healthy"
  }
`;
```

---

### 🔄 Type-Safe State - Runtime Validation with InSpatial Type

InSpatial State integrates with the InSpatial Type system to provide runtime validation of your application state, ensuring it always matches its expected structure.

```typescript
import { createState, StateTypes } from "@inspatial/state"
import { type } from "@inspatial/type"

// Use a predefined state type
const toggleState = createState({
  id: "feature-flags",
  initialState: { enabled: false },
  type: StateTypes.Toggle
});

// Or create a custom type with complex validation
const ProductType = type({
  id: "string",
  name: "string|minLength(2)|maxLength(100)",
  price: "number|>0",
  stock: "number|>=0|integer", 
  category: "'electronics'|'clothing'|'food'|'books'",
  tags: "string[]"
});

const productState = createState({
  id: "product",
  initialState: {
    id: "prod-001",
    name: "Smartphone",
    price: 599.99,
    stock: 50,
    category: "electronics",
    tags: ["tech", "mobile", "gadget"]
  },
  type: ProductType
});

// Invalid updates will be caught
try {
  productState.update({ price: -100 }); // Invalid: price must be > 0
} catch (error) {
  console.error("Price validation failed:", error);
}

try {
  productState.update({ category: "vehicles" }); // Invalid: not in allowed categories
} catch (error) {
  console.error("Category validation failed:", error);
}

// You can disable validation for specific states
const nonValidatedProduct = createState({
  id: "draft-product",
  initialState: {
    id: "draft-001",
    name: "New Product",
    price: 0 // Would be invalid with validation
  },
  type: ProductType // Type still used for documentation
}, {
  validateType: false // Disable validation
});
```

#### Type-Safe State Functions

| Function            | Description                                        |
| ---- | ----- |
| `createState()`  | Creates state with optional type validation (enabled by default) |
| `validateState()`  | Validates a state object against a type schema |
| `isTypeError()`  | Type guard to check for validation errors |
| `registerStateSchema()`  | Registers a state schema for reuse |
| `getStateJsonSchema()`  | Converts a state type to JSON Schema for documentation |

#### Predefined State Types

| Type                        | Description                                                 |
| ----- | ----- |
| `StateTypes.Counter`  | Type for numeric counter states |
| `StateTypes.Toggle`  | Type for boolean toggle states |
| `StateTypes.List`  | Type for list/collection states |
| `StateTypes.Form`  | Type for form state with validation |
| `StateTypes.User`  | Type for user profile states |
| `StateTypes.Pagination`  | Type for pagination states |
| `StateTypes.Notification`  | Type for notification handling |
| `StateTypes.Theme`  | Type for theme/appearance states |

### 🧩 Trigger System Integration - Actions and Events

Connect your state to the InSpatial Trigger system for responsive, event-driven applications.

```typescript
import { createState } from "@inspatial/state"
import { registerTrigger } from "@inspatial/trigger"

// Define triggers for a shopping cart
const addItemTrigger = registerTrigger("cart:addItem", 
  (state, item, quantity = 1) => {
    const existingItem = state.items.find(i => i.id === item.id);
    
    if (existingItem) {
      // Update existing item quantity
      return {
        items: state.items.map(i => 
          i.id === item.id
            ? { ...i, quantity: i.quantity + quantity }
            : i
        )
      };
    } else {
      // Add new item
      return {
        items: [...state.items, { ...item, quantity }]
      };
    }
  }
);

const removeItemTrigger = registerTrigger("cart:removeItem", 
  (state, itemId) => ({
    items: state.items.filter(item => item.id !== itemId)
  })
);

const clearCartTrigger = registerTrigger("cart:clear", 
  () => ({ items: [] })
);

// Create state connected to triggers
const cartState = createState({
  id: "shopping-cart",
  initialState: { items: [] },
  triggers: ["cart:addItem", "cart:removeItem", "cart:clear"]
});

// Use the generated actions
cartState.action.addItem({ id: "prod1", name: "Laptop", price: 999.99 });
cartState.action.addItem({ id: "prod2", name: "Mouse", price: 49.99 }, 2);
cartState.action.removeItem("prod2");
cartState.action.clear();
```

### 🔍 JSON Schema Generation for Documentation

Generate JSON Schema documentation automatically from your state types:

```typescript
import { getStateJsonSchema } from "@inspatial/state"
import { type } from "@inspatial/type"

// Define a complex state type
const UserProfileType = type({
  username: "string|minLength(3)|maxLength(20)",
  email: "string|regex(/@.+\\..+$/)",
  age: "number|>=18|<=120", 
  preferences: {
    theme: "'light'|'dark'|'system'",
    notifications: "boolean",
    language: "'en'|'es'|'fr'|'de'|'ja'|'zh'"
  }
});

// Generate JSON Schema
const schema = getStateJsonSchema(UserProfileType, {
  title: "User Profile Schema",
  description: "Schema for user profile data"
});

// Output schema for documentation
console.log(JSON.stringify(schema, null, 2));
```

## 🤔 FAQ

### "Can I use InSpatial State without the type validation?"
Yes, absolutely! The type system integration is optional. If you don't provide a type in your state configuration, no validation will be performed. You can use InSpatial State as a lightweight state container without any validation overhead.

### "How does the performance compare to other state management libraries?"
InSpatial State is optimized for performance with features like batched updates, memoization, and optimized subscriptions. The type validation has minimal runtime overhead as it's designed to be performant. You can also disable validation in production environments if needed.

### "Can I use this with React, Vue, or other frameworks?"
Yes! InSpatial State is framework-agnostic and can be used with any UI framework. There are specific bindings available for popular frameworks that provide optimized integration with their reactivity systems.

### "What happens when type validation fails?"
By default, type validation errors are logged to the console in development mode but don't throw errors. This behavior can be configured to be stricter by using `withTypeValidation` with custom error handling options.

### "Can I create derived state that depends on multiple state objects?"
Yes, you can use `createDerivedState` or `createDerivedStateFromMultiple` to create state that derives its values from one or more source states. These will update automatically when any of the source states change.

## 🎯 API Reference

### Core Functions

| Function         | Description              |
| ---- | --- |
| `createState()` | Create a new state instance |
| `stateQL()` | Enhance a state with template literal syntax |
| `withTypeValidation()` | Add type validation to a state |
| `createComputed()` | Create a computed value from state |
| `createDerivedState()`   | Create state derived from another state |
| `connectTriggerToState()`   | Connect a trigger to a state instance |
| `setupPersistence()`   | Configure persistence for a state instance |

### Type System Integration

| Class/Type  | Description           |
| ----- | --- |
| `StateTypes` | Predefined common state types |
| `TypeErrors` | Collection of validation errors |

### StateQL Features

| Feature       | Description             |
| ---- | ----- |
| `Template Literals` | Update state with expressive syntax |
| `Conditional Logic` | Use if/else in state updates |
| `Array Operations` | Push, pop, splice built in |

### TypeScript Interfaces

This package exports the following TypeScript interfaces and types:

| Interface        | Description                |
| ---- | ----- |
| `StateConfig`  | Configuration for creating state  |
| `StateInstance`  | Core state instance interface  |
| `StateQLInstance`  | State with template literal support  |
| `PersistOptions`  | Options for state persistence  |
| `StateOptions`  | Additional state creation options  |
| `ComputedOptionsType`  | Options for computed values  |
| `DerivedStateOptionsType`  | Options for derived state  |
| `StorageAdapterType`  | Interface for storage adapters  |

---

## 🤝 Contributing

We welcome contributions from the community! Please read our [Contributing Guidelines](CONTRIBUTING.md) to get started.

---

## 📄 License

InSpatial Core is released under the Apache 2.0 License. See the [LICENSE](LICENSE) file for details.

---

<div align="center">
  <strong>Ready to shape the future of spatial computing?</strong>
  <br>
  <a href="https://www.inspatiallabs.com">Start Building with InSpatial</a>
</div>

<style>
.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.feature-tile {
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 15px;
  background-color: #f8f9fa;
  cursor: pointer;
  transition: all 0.3s ease;
}

.feature-tile:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(0,0,0,0.1);
  background-color: #fff;
}

.feature-icon {
  font-size: 24px;
  display: block;
  margin-bottom: 10px;
}

.feature-brief {
  color: #555;
  font-size: 14px;
  margin-top: 5px;
}

#feature-details-container {
  margin-top: 30px;
  border-top: 1px solid #eee;
  padding-top: 20px;
}

.feature-detail {
  display: none;
  animation: fadeIn 0.5s;
  padding: 20px;
  border-radius: 8px;
  background-color: #f8f9fa;
  margin-bottom: 20px;
}

.feature-detail h4 {
  margin-top: 0;
}

.feature-benefits {
  margin-top: 15px;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
</style>

<script>
function showFeatureDetails(featureId) {
  // Hide all feature details
  document.querySelectorAll('.feature-detail').forEach(detail => {
    detail.style.display = 'none';
  });
  
  // Show the selected feature detail
  const selectedFeature = document.getElementById(featureId);
  if (selectedFeature) {
    selectedFeature.style.display = 'block';
    selectedFeature.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
}

// Show the first feature by default
document.addEventListener('DOMContentLoaded', function() {
  showFeatureDetails('feature-system-1');
});
</script> 